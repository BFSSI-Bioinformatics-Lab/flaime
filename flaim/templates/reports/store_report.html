{% extends 'reports_base.html' %}
{% block section %}Store Report{% endblock %}

{% block header %}
  <div style="flex: 10%">
    {% load static %}
    <img src="{% static 'images/store_icons/' %}{{ image }}.png" height="160" width="160" style="padding-bottom: 5px">
  </div>
  <div style="flex: 90%;padding-left: 10px">
    <div style="padding-left: 60px">
      <div class="row" style="text-align: left">
      <h1>{{ store }}</h1>
        <div class="dropdown show" style="padding-top: 10px; padding-left: 10px">
        <a class="btn btn-primary btn-sm dropdown-toggle" href="#" role="button"
           id="dropdownMenuLink"
           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          More
        </a>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink" style="overflow-y:auto; max-height: 300px">
          {% for store in product_stores %}
            <a class="dropdown-item" href="/reports/store/{{ store }}/">{{ store }}</a>
          {% endfor %}
        </div>
      </div>
    </div>
    </div>
    <div style="display: flex;text-align:center">
      <div style="flex: auto">
        Product Count</br>
        <h1>{{ product_count }}</h1>
      </div>
      <div style="flex: auto">
        Products with NFTs
        <h1>{{ has_nft }}</h1>
      </div>
      <div style="flex: auto">
        Products Over 15% Sodium
        <h1>{{ sodium_products_over_15 }}</h1>
      </div>
      <div style="flex: auto">
        Products Over 15% Sat. Fat
        <h1>{{ fat_products_over_15 }}</h1>
      </div>
      <div style="flex: auto">
        Products Over 15% Sugar
        <h1>{{ sugar_products_over_15 }}</h1>
      </div>
    </div>
  </div>

{% endblock %}

{% block body %}
  <div style="flex: 33%; padding-right: 25px">
    {#  top 3 brands, avg cost? #}
    <b>Overview:</b> {{ store }} has a total of {{ product_count }} products across {{ category_count }} food
    categories. <b>{{ manual_category_count }}</b> of the store's products were manually verified and the rest were
    assigned categories using a machine learning model.
  </div>
  <div style="flex: 33%; padding-right: 25px; padding-left: 25px">
    {# add rankings #}
    <b>Products:</b> Of the {{ store }} products with nutrition fact tables, <b>{{ sodium_products_percent }}</b> are
    over 15% sodium, <b>{{ fat_products_percent }}</b> are over 15% saturated fat, and <b>{{ sugar_products_percent }}</b>
    are over 15% sugar.
{#    The most common categories are {{ common_categories }}.#}
  </div>
  <div style="flex: 33%; padding-left: 25px">
    <b>Brands:</b> The 5 top {{ store }} brands are {{ common_brands }}.
  </div>
{% endblock %}

{% block lower %}
  {% block product_javascript %}
    <script src="{% static 'bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'plotly.js-dist/plotly.js' %}"></script>
  {% endblock %}
  <div style="flex: 20%;padding-top: 20px">
    <h3>
      Products over 15% Daily Value for Select Categories
    </h3>
    <br>
    <p>
      Five categories were selected to visualize the difference in number of products which exceeded the 15% daily value
       threshold for three different nutrients of interest: sodium, saturated fat, and sugar.
      <br><br>
      <small>
        Note that products in the database have not been categorized by requirement to carry an NFT on their physical
        packaging. Hence, a caveat of this product count/percentage is that the number of products without NFTs includes
        products that would not be expected to carry them anyway (e.g. fresh fruits and vegetables). Regardless, many
        categories have a lower number of products with NFTs than expected (e.g. soups).
      </small>
    </p>
  </div>
  <div style="flex: 80%">
    {% autoescape off %}
      {{ figure1 }}
    {% endautoescape %}
  </div>
{% endblock %}
